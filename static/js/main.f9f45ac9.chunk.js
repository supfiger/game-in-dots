(this.webpackJsonpstarnavi=this.webpackJsonpstarnavi||[]).push([[0],{16:function(e,t,n){e.exports=n(53)},22:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(15),s=n.n(i),c=n(1),o=n.n(c),l=n(4),u=n(7),m=n(8),d=n(12),h=n(11),p=(n(22),n(10)),f=n.n(p),g=n(5),v=n.n(g),b=(n(44),function(e){var t=e.winnersList,n=e.loadingWinners,a=e.isGameFinished,i=t&&t.length>0,s={winnersListItem:!0,highlightLastWinner:a};return r.a.createElement("div",{className:"Board"},r.a.createElement("h2",{className:"boardTitle"},"Leader Board"),n&&!a&&r.a.createElement(f.a,{type:"TailSpin",color:"#00BFFF",height:60,width:60}),i&&r.a.createElement("ul",{className:"winnersList"},t.map((function(e){return r.a.createElement("li",{key:e.id,className:v()(s)},r.a.createElement("div",{className:"winnerUsername"},e.winner),r.a.createElement("div",{className:"winnerDate"},e.date))}))))}),S=(n(45),function(e){var t=e.onClick,n=e.color,a=e.field,i={small:15===a,middle:10===a,big:5===a};return r.a.createElement("li",{className:v()("Dot",n,i),onClick:t})}),j=(n(46),function(e){var t=e.field,n=e.fieldDots;return r.a.createElement("div",{className:"Field"},t&&r.a.createElement("ul",{className:"grid"},n.map((function(n){return r.a.createElement(S,Object.assign({key:n.id,onClick:function(){return e.onClickDot(n.id)}},n,{field:t}))}))))}),w=n(3),O=n(6),k=n(9),E=n(13),G=(n(49),function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).onChangeGameMode=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(k.a)(a),r=n.props.gameSettings,i=t.target.value,!a.state.isGameStarted){e.next=5;break}return e.next=5,a.resetState();case 5:a.setState({gameMode:i,field:r[i].field,delay:r[i].delay},(function(){return a.createFieldDots()}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeName=function(e){a.setState({user:e.target.value})},a.onClickPlay=function(){var e=a.state,t=e.isGameStarted;e.isGameFinished&&a.createFieldDots(),t||a.setState({isGameStarted:!0,isGameFinished:!1},(function(){return a.onStartGame()}))},a.createFieldDots=function(){for(var e=a.state.field,t=[],n=Math.pow(e,2),r=0;r<n;r++)t[r]={color:"initial",clicked:!1,id:r};a.setState({fieldDots:t,max:n,field:e})},a.onStartGame=function(){var e=a.state,t=e.delay,n=e.max,r=Object(E.sampleSize)(Object(E.range)(0,n),n),i=0,s=setInterval((function(){i++,a.checkIsGameFinished(i)?(a.onFinishGame(),clearInterval(s)):a.generateRandomDot(r)}),t)},a.generateRandomDot=function(e){var t=a.state,n=t.isGameStarted,r=t.isGameFinished,i=t.fieldDots,s=t.lastNumber,c=t.points;if(n&&!r){var o=Object(O.a)(i),l=Object(w.a)({},c),u=s,m=o[s];null!==u&&"green"!==m.color&&(o[m.id]=Object(w.a)(Object(w.a)({},m),{},{color:"red"}),l=Object(w.a)(Object(w.a)({},l),{},{computer:[].concat(Object(O.a)(l.computer),[m.id])}));var d=e.pop();o[d].color="blue",a.setState({fieldDots:o,lastNumber:d,points:l})}},a.onClickDot=function(e){var t=a.state,n=t.fieldDots,r=t.points,i=t.lastNumber,s=Object(w.a)({},r),c=Object(O.a)(n),o=c[i];e===i&&!1===o.clicked&&(o.color="green",o.clicked=!0,s=Object(w.a)(Object(w.a)({},s),{},{user:[].concat(Object(O.a)(s.user),[i])}),a.setState({fieldDots:c,points:s}))},a.makeLastDotRed=function(){var e=a.state,t=e.lastNumber,n=e.points,r=e.fieldDots,i=Object(O.a)(r),s=Object(w.a)({},n),c=i[t];null!==t&&"green"!==c.color&&(i[c.id]=Object(w.a)(Object(w.a)({},c),{},{color:"red"}),s=Object(w.a)(Object(w.a)({},s),{},{computer:[].concat(Object(O.a)(s.computer),[c.id])})),a.setState({fieldDots:i,points:s})},a.onFinishGame=Object(l.a)(o.a.mark((function e(){var t,n,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.points,r=t.max,i=t.user,n.computer.length===Math.floor(r/2)&&a.setState({winner:"computer",isGameFinished:!0}),n.user.length===Math.floor(r/2)&&a.setState({winner:i,isGameFinished:!0}),e.next=5,a.makeLastDotRed();case 5:if(null===a.state.winner){e.next=8;break}return e.next=8,a.publishWinnerToBoard();case 8:a.resetState();case 9:case"end":return e.stop()}}),e)}))),a.checkIsGameFinished=function(e){var t=a.state,n=t.points,r=t.max;return n.computer.length===Math.floor(r/2)||n.user.length===Math.floor(r/2)||!a.state.isGameStarted||e===r},a.resetState=function(){a.setState(Object(w.a)({},{isGameStarted:!1,lastNumber:null,dataToPublish:{},points:{computer:[],user:[]}}))},a.publishWinnerToBoard=function(){var e=a.state,t=e.dataToPublish,n=e.winner,r=e.isGameFinished,i=Object(w.a)({},t),s=new Date,c="".concat(s.toLocaleString("default",{hour:"numeric",minute:"numeric"}),"; ").concat(s.getDate()," ").concat(s.toLocaleString("en",{month:"long"})," ").concat(s.getFullYear());i.winner=n,i.date=c,a.props.onPublishWinner(i,r)},a.state={user:"",winner:null,gameMode:"DEFAULT",isGameStarted:!1,isGameFinished:!1,field:null,delay:null,max:null,fieldDots:[],dataToPublish:{},lastNumber:null,points:{computer:[],user:[]}},a}return Object(m.a)(n,[{key:"render",value:function(){var e=this.state,t=this.props,n=t.gameSettings,a=t.loadingSettings,i=Object(w.a)(Object(w.a)({},e),{},{gameSettings:n}),s={content:!0,isGameModePicked:"DEFAULT"!==this.state.gameMode};return r.a.createElement("div",{className:"Game"},r.a.createElement("h1",{className:"gameTitle"},"Game in dots"),a?r.a.createElement(f.a,{type:"TailSpin",color:"#00BFFF",height:60,width:60}):r.a.createElement("div",{className:v()(s)},r.a.createElement(F,Object.assign({},i,{onChangeGameMode:this.onChangeGameMode,onChangeName:this.onChangeName,onClickPlay:this.onClickPlay})),r.a.createElement(x,i),r.a.createElement(j,Object.assign({},i,{onClickDot:this.onClickDot}))))}}]),n}(a.Component)),x=(n(50),function(e){var t=e.isGameFinished,n=e.winner,i={Message:!0,messageVisible:null!==n&&""!==n};return r.a.createElement("div",{className:v()(i)},t&&r.a.createElement(a.Fragment,null,r.a.createElement("span",null,n)," won"))}),F=(n(51),function(e){var t=e.gameMode,n=e.gameSettings,a=e.isGameStarted,i=e.isGameFinished,s=e.user,c="DEFAULT"===t||""===s||a;return r.a.createElement("div",{className:"Panel"},r.a.createElement("div",{className:"gameMode"},r.a.createElement("select",{value:t,onChange:e.onChangeGameMode},r.a.createElement("option",{value:"DEFAULT",disabled:!0},"Pick game mode..."),Object.keys(n).map((function(e){return r.a.createElement("option",{value:e,key:e},e)})))),r.a.createElement("div",{className:"inputName"},r.a.createElement("input",{value:s,onChange:e.onChangeName,type:"text",placeholder:"Enter your user"})),r.a.createElement("button",{className:"playButton",onClick:e.onClickPlay,disabled:c},i?"PLAY AGAIN":"PLAY"))}),y="https://starnavi-frontend-test-task.herokuapp.com",N=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(y+"/game-settings",{method:"GET"});case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:e.prev=10,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(y+"/winners",{method:"GET"});case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:e.prev=10,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(y+"/winners",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:e.prev=10,e.t0=e.catch(0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),W=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).fetchWinners=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loadingWinners:!0}),e.prev=1,e.next=4,D();case 4:t=e.sent,a.setState({winnersList:t.reverse()}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:return e.prev=11,a.setState({loadingWinners:!1}),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])}))),a.fetchGameSettings=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loadingSettings:!0}),e.prev=1,e.next=4,N();case 4:t=e.sent,a.setState({gameSettings:t}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:return e.prev=11,a.setState({loadingSettings:!1}),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])}))),a.setPublishWinner=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),a.onPublishWinner=function(){var e=Object(l.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setPublishWinner(t);case 2:a.fetchWinners(),a.setState({isGameFinished:n});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a.state={winnersList:{},gameSettings:{},loadingWinners:!1,loadingSettings:!1,isGameFinished:!1},a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.fetchGameSettings(),this.fetchWinners()}},{key:"render",value:function(){var e=this.state,t=e.winnersList,n=e.gameSettings,a=e.loadingSettings,i=e.loadingWinners,s=e.isGameFinished;return r.a.createElement("div",{className:"App"},r.a.createElement(G,{loadingSettings:a,gameSettings:n,onPublishWinner:this.onPublishWinner}),r.a.createElement(b,{loadingWinners:i,winnersList:t,isGameFinished:s}))}}]),n}(a.Component);n(52),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[16,1,2]]]);
//# sourceMappingURL=main.f9f45ac9.chunk.js.map